#!/usr/bin/env python3
# /// script
# requires-python = ">=3.13"
# dependencies = [
#     "pwntools",
# ]
# ///

from pwn import *

context.arch = 'amd64'

payload = [0x48,0x31,0xc0,0xb8,0x0a,0x00,0x00,0x00,0x50,0x48,
    0xb8,0x72,0x64,0x65,0x72,0x20,0x36,0x36,0x3a,0x50,
    0x48,0xb8,0x6e,0x64,0x20,0x74,0x68,0x65,0x20,0x6f,
    0x50,0x48,0xb8,0x2c,0x20,0x79,0x6f,0x75,0x20,0x66,
    0x69,0x50,0x48,0xb8,0x43,0x6f,0x6e,0x67,0x72,0x61,
    0x74,0x65,0x50,0xb8,0x01,0x00,0x00,0x00,0xbf,0x01,
    0x00,0x00,0x00,0x48,0x89,0xe6,0xba,0x21,0x00,0x00,
    0x00,0x0f,0x05,0x48,0x31,0xc0,0x50,0x48,0xb8,0x66,
    0x6c,0x61,0x67,0x2e,0x74,0x78,0x74,0x50,0x48,0x89,
    0xe7,0x48,0x31,0xc0,0xb8,0x02,0x00,0x00,0x00,0x48,
    0x31,0xf6,0x0f,0x05,0x48,0x89,0xc7,0xb8,0x00,0x00,
    0x00,0x00,0x48,0x89,0xe6,0xba,0x20,0x00,0x00,0x00,
    0x0f,0x05,0xb8,0x01,0x00,0x00,0x00,0xbf,0x01,0x00,
    0x00,0x00,0x48,0x89,0xe6,0x0f,0x05,0xb8,0x3c,0x00,
    0x00,0x00,0x48,0x31,0xff,0x0f,0x05]

hidden_payload = disasm(bytes(payload))
write('hidden-payload.txt', hidden_payload)
write('hidden-payload.bin', bytes(payload))
print(hidden_payload)
